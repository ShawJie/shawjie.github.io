<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Hexo Theme Keep"><meta name="description" content="Hexo Theme Keep"><meta name="author" content="ShawJie"><title>Design Pattern 基础设计模式 | Shaw&#39;s Log | 茶歇小栈</title><link rel="stylesheet" href="/css/style.css"><link rel="shortcut icon" href="/images/base_icon.ico"><link rel="stylesheet" href="/font/css/fontawesome.min.css"><link rel="stylesheet" href="/font/css/regular.min.css"><link rel="stylesheet" href="/font/css/solid.min.css"><link rel="stylesheet" href="/font/css/brands.min.css"><script class="keep-theme-configurations">const KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"shawjie.cn",root:"/",language:"en"},KEEP.theme_config={base_info:{primary_color:"#26de81",avatar:"/images/dear_kana.jpg",logo:"/images/dear_kana.jpg",favicon:"/images/base_icon.ico"},menu:{Archives:"/archives",Tags:"/tags",About:"/about"},first_screen:{enable:!0,background_img:"/images/bg.svg",background_img_dark:"/images/bg.svg",description:"愿中国青年都摆脱冷气，只是向上走，不必听自暴自弃者流的话。||能做事的做事，能发声的发声",hitokoto:!1},social_contact:{enable:!1,links:{github:null,weixin:null,qq:null,weibo:null,zhihu:null,twitter:null,facebook:null,email:null}},scroll:{progress_bar:!1,percent:!0,hide_header:!0},home:{category:!0,tag:!0,announcement:null},post:{author_badge:{enable:!1,level_badge:!0,custom_badge:["One","Two","Three"]},word_count:{wordcount:!0,min2read:!0},datetime_format:"YYYY-MM-DD HH:mm:ss",copyright_info:!1,share:!1,reward:{enable:!1,img_link:null,text:null}},code_block:{tools:{enable:!0,style:"mac"},highlight_theme:"default"},toc:{enable:!0,number:!1,expand_all:!0,init_open:!0,layout:"right"},website_count:{busuanzi_count:{enable:!1,site_uv:!0,site_pv:!0,page_pv:!0}},local_search:{enable:!0,preload:!0},comment:{enable:!1,use:"valine",valine:{appid:null,appkey:null,server_urls:null,placeholder:null},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null,proxy:null},twikoo:{env_id:null,region:null,version:"1.6.21"},waline:{server_url:null,reaction:!1,version:2},giscus:{repo:null,repo_id:null,category:"Announcements",category_id:null,reactions_enabled:!1},artalk:{server:null},disqus:{shortname:null}},rss:{enable:!1},lazyload:{enable:!0},cdn:{enable:!1,provider:"jsdelivr"},pjax:{enable:!0},footer:{since:2019,word_count:!1,icp:{enable:!0,record_code:"浙ICP备20000303号-1",url:"https://beian.miit.gov.cn"},site_deploy:{enable:!1,provider:"github",url:null},shields_style:{enable:!1,custom:[{link_url:null,img_url:null}]}},inject:{enable:!0,css:[null],js:["/js/shawjie_modify.js"]},root:"",version:"4.0.5"},KEEP.language_ago={second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days ago",week:"%s weeks ago",month:"%s months ago",year:"%s years ago"},KEEP.language_code_block={copy:"Copy code",copied:"Copied",fold:"Fold code block",folded:"Folded"},KEEP.language_copy_copyright={copy:"Copy copyright info",copied:"Copied",title:"Original post title",author:"Original post author",link:"Original post link"}</script><meta name="generator" content="Hexo 7.0.0"></head><body><div class="progress-bar-container"><span class="pjax-progress-bar"></span> <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i></div><main class="page-container border-box"><div class="page-main-content border-box"><div class="page-main-content-top"><header class="header-wrapper"><div class="border-box header-content"><div class="left border-box"><a class="logo-image border-box" href="/"><img src="/images/dear_kana.jpg"> </a><a class="site-name border-box" href="/">Shaw&#39;s Log | 茶歇小栈</a></div><div class="right border-box"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="/">HOME</a></li><li class="menu-item"><a href="/archives">ARCHIVES</a></li><li class="menu-item"><a href="/tags">TAGS</a></li><li class="menu-item"><a href="/about">ABOUT</a></li><li class="menu-item search search-popup-trigger"><i class="fas search fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">HOME</a></li><li class="drawer-menu-item flex-center"><a href="/archives">ARCHIVES</a></li><li class="drawer-menu-item flex-center"><a href="/tags">TAGS</a></li><li class="drawer-menu-item flex-center"><a href="/about">ABOUT</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle border-box"><div class="main-content border-box"><div class="fade-in-down-animation"><div class="post-page-container border-box"><div class="post-content-container border-box"><div class="post-content-top border-box" style="height:13.8rem"><div class="cover-post-title">Design Pattern 基础设计模式</div><img class="post-cover" src="/images/design-pattern/dp5NlbzE8skt9Mn.png" onerror='this.style.display="none"'></div><div class="post-content-bottom border-box has-cover"><div class="post-header border-box"><div class="avatar-box border-box"><img src="/images/dear_kana.jpg"></div><div class="info-box"><div class="author border-box"><span class="name">ShawJie</span></div><div class="meta-info border-box"><div class="post-meta-info-container border-box post"><div class="post-meta-info border-box"><span class="meta-info-item post-create-date"><i class="icon fa-solid fa-calendar-check"></i>&nbsp; <span class="pc">2019-07-12 18:33:21</span> <span class="mobile">2019-07-12 18:33</span> </span><span class="meta-info-item post-update-date"><i class="icon fa-solid fa-file-pen"></i>&nbsp; <span class="pc" data-updated="Thu Nov 30 2023 10:02:18 GMT+0800">2023-11-30 10:02:18</span> </span><span class="post-tag meta-info-item border-box"><i class="icon fas fa-tags"></i>&nbsp;<ul class="post-tag-ul"><li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/Design-Pattern/">Design Pattern</a></li></ul></span></div></div></div></div></div><div class="post-content keep-markdown-body"><h1 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h1><blockquote><p><strong>目的：</strong><br>设计模式并不直接用来完成代码的编写，而是描述在各种不同情况下，要怎么解决问题的一种方案。面向对象设计模式通常以类别或对象来描述其中的关系和相互作用，但不涉及用来完成应用程序的特定类别或对象。设计模式能使不稳定依赖于相对稳定、具体依赖于相对抽象，避免会引起麻烦的紧耦合，以增强软件设计面对并适应变化的能力。</p></blockquote><hr><blockquote><p><strong>原则：</strong><br>开闭原则：实现热插拔，提高扩展性。<br>里氏代换原则：实现抽象的规范，实现子父类互相替换；<br>依赖倒转原则：针对接口编程，实现开闭原则的基础；<br>接口隔离原则：降低耦合度，接口单独设计，互相隔离；<br>迪米特法则，又称不知道原则：功能模块尽量独立；<br>合成复用原则：尽量使用聚合，组合，而不是继承；</p></blockquote><h1 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h1><h2 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h2><p><strong>意图：</strong>定义一个创建对象的接口，让其子类自己决定实例化哪一个工厂类，工厂模式使其创建过程延迟到子类进行。<br><strong>主要解决:</strong> 主要解决接口选择的问题。<br><strong>何时使用:</strong> 我们明确地计划不同条件下创建不同实例时。<br><strong>如何解决:</strong> 让其子类实现工厂接口，返回的也是一个抽象的产品。<br><strong>关键代码:</strong> 创建过程在其子类执行。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/factory_pattern_uml_diagram.jpg"></p><blockquote><p>工厂模式是处理在不指定对象具体类型的情况下创建对象的问题。工厂方法模式的实质是”定义一个创建对象的接口，但让实现这个接口的类来决定实例化哪个类。工厂方法让类的实例化推迟到子类中进行。”</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//创建一个接口</span><br><span class="line">public  interface  Shape  &#123;  void  draw(); &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> //创建实现接口的实体类</span><br><span class="line"> public  class  Rectangle  implements  Shape  &#123; </span><br><span class="line">    @Override  </span><br><span class="line">    public  void  draw()  &#123;  </span><br><span class="line">        System.out.println(&quot;Inside Rectangle::draw() method.&quot;); </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line">public  class  Square  implements  Shape  &#123; </span><br><span class="line">    @Override  </span><br><span class="line">    public  void  draw()  &#123;  </span><br><span class="line">        System.out.println(&quot;Inside Square::draw() method.&quot;); </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line">public  class  Circle  implements  Shape  &#123; </span><br><span class="line">    @Override  </span><br><span class="line">    public  void  draw()  &#123;  </span><br><span class="line">        System.out.println(&quot;Inside Circle::draw() method.&quot;); </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public  class  ShapeFactory  &#123;  </span><br><span class="line">    //使用 getShape 方法获取形状类型的对象</span><br><span class="line">    //若获取实例方法为Static(静态的)则是简单工厂模式</span><br><span class="line">    public Shape getShape(String  shapeType)&#123;  </span><br><span class="line">        if(shapeType == null)&#123;  </span><br><span class="line">            return  null; </span><br><span class="line">        &#125;  </span><br><span class="line">        if(shapeType.equalsIgnoreCase(&quot;CIRCLE&quot;))&#123;  </span><br><span class="line">            return  new  Circle(); </span><br><span class="line">        &#125;else if(shapeType.equalsIgnoreCase(&quot;RECTANGLE&quot;))&#123;  </span><br><span class="line">            return  new  Rectangle(); </span><br><span class="line">        &#125;else if(shapeType.equalsIgnoreCase(&quot;SQUARE&quot;))&#123; </span><br><span class="line">            return  new  Square();</span><br><span class="line">        &#125;  </span><br><span class="line">        return  null;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//调用工厂类</span><br><span class="line">ShapeFactory factory = new ShapeFactory();</span><br><span class="line">Shape shape = factory.getShap(&quot;CIRCLE&quot;);</span><br><span class="line">shape = factory.getShap(&quot;RECTANGLE&quot;);</span><br><span class="line">shape = factory.getShap(&quot;SQUARE&quot;);</span><br></pre></td></tr></table></figure><blockquote><p><strong>总结：</strong><br>优点： 1、一个调用者想创建一个对象，只要知道其名称就可以了。 2、扩展性高，如果想增加一个产品，只要扩展一个工厂类就可以。 3、屏蔽产品的具体实现，调用者只关心产品的接口。<br>缺点：每次增加一个产品时，都需要增加一个具体类和对象实现工厂，使得系统中类的个数成倍增加，在一定程度上增加了系统的复杂度，同时也增加了系统具体类的依赖。这并不是什么好事。</p></blockquote><h2 id="抽象工厂"><a href="#抽象工厂" class="headerlink" title="抽象工厂"></a>抽象工厂</h2><p><strong>意图：</strong>提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。<br><strong>主要解决：</strong>主要解决接口选择的问题。<br><strong>何时使用：</strong>系统的产品有多于一个的产品族，而系统只消费其中某一族的产品。<br><strong>如何解决：</strong>在一个产品族里面，定义多个产品。<br><strong>关键代码：</strong>在一个工厂里聚合多个同类产品。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/abstractfactory_pattern_uml_diagram.jpg"></p><blockquote><p>抽象工厂模式提供了一种方式，可以将一组具有同一主题的单独的工厂封装起来。在正常使用中，客户端程序需要创建抽象工厂的具体实现，然后使用抽象工厂作为接口来创建这一主题的具体对象。客户端程序不需要知道（或关心）它从这些内部的工厂方法中获得对象的具体类型，因为客户端程序仅使用这些对象的通用接口。抽象工厂模式将一组对象的实现细节与他们的一般使用分离开来。</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">//创建接口</span><br><span class="line">public interface Button &#123;&#125;</span><br><span class="line">public interface Border &#123;&#125;</span><br><span class="line"></span><br><span class="line">//Mac系实体类</span><br><span class="line">public class MacButton implements Button &#123;&#125;</span><br><span class="line">public class MacBorder implements Border &#123;&#125;</span><br><span class="line">//Win系实体类</span><br><span class="line">public class WinButton implements Button &#123;&#125;</span><br><span class="line">public class WinBorder implements Border &#123;&#125;</span><br><span class="line"></span><br><span class="line">//创建工厂</span><br><span class="line">public class MacFactory &#123;</span><br><span class="line">    public static Button createButton() &#123;</span><br><span class="line">        return new MacButton();</span><br><span class="line">    &#125;</span><br><span class="line">        public static Border createBorder() &#123;</span><br><span class="line">        return new MacBorder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">public class WinFactory &#123;</span><br><span class="line">    public static Button createButton() &#123;</span><br><span class="line">        return new WinButton();</span><br><span class="line">    &#125;</span><br><span class="line">        public static Border createBorder() &#123;</span><br><span class="line">        return new WinBorder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h2><p><strong>意图：</strong>保证一个类仅有一个实例，并提供一个访问它的全局访问点。<br><strong>主要解决：</strong>一个全局使用的类频繁地创建与销毁。<br><strong>何时使用：</strong>当您想控制实例数目，节省系统资源的时候。<br><strong>如何解决：</strong>判断系统是否已经有这个单例，如果有则返回，如果没有则创建。<br><strong>关键代码：</strong>构造函数是私有的。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/singleton_pattern_uml_diagram.jpg"></p><blockquote><p><strong>实现：</strong><br>我们将创建一个 <em>SingleObject</em> 类。<em>SingleObject</em> 类有它的私有构造函数和本身的一个静态实例。<br><em>SingleObject</em> 类提供了一个静态方法，供外界获取它的静态实例。_SingletonPatternDemo_，我们的演示类使用 <em>SingleObject</em> 类来获取 _SingleObject_对象</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * 主动模式（饿汉模式）</span><br><span class="line"> * 使用ClassLoader的特性保证了线程的安全</span><br><span class="line"> * 非Lazy Load模式，浪费了内存</span><br><span class="line"> */</span><br><span class="line">public class SingleObject&#123;  </span><br><span class="line">    //创建 SingleObject 的一个对象  </span><br><span class="line">    private static SingleObject instance = new  SingleObject(); </span><br><span class="line">    //让构造函数为 private，这样该类就不会被实例化  </span><br><span class="line">    private SingleObject()&#123;&#125;  </span><br><span class="line">    //获取唯一可用的对象 </span><br><span class="line">    public static SingleObject getInstance()&#123;  </span><br><span class="line">        return  instance; </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * 被动模式（懒汉模式）</span><br><span class="line"> * 线程不安全 若需线程安全 需给getInstance()加上Synchronized关键词</span><br><span class="line"> * 保证了线程安全但降低了效率</span><br><span class="line"> */</span><br><span class="line">public class SingleObject&#123;</span><br><span class="line">    //创建一个SingleObject对象 但不实例化</span><br><span class="line">    private static SingleObject instance;</span><br><span class="line">    private SingleObject()&#123;&#125;</span><br><span class="line">    public static SingleObject getInstance()&#123;</span><br><span class="line">        if(instance == null)&#123;</span><br><span class="line">            instance = new SingleObject();</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * Double-checked-locking模式</span><br><span class="line"> * 线程安全 且为Lazy Load加载方式</span><br><span class="line"> */</span><br><span class="line">public class SingleObject&#123;</span><br><span class="line">    private static SingleObject instance;</span><br><span class="line">    private SingleObject()&#123;&#125;</span><br><span class="line">    public static SingleObject getInstance()&#123;</span><br><span class="line">        if(instance == null)&#123;</span><br><span class="line">            synchronized(SingleObject.class)&#123;</span><br><span class="line">                if(instance == null)</span><br><span class="line">                    instance = new SingleObject();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="生成器模式"><a href="#生成器模式" class="headerlink" title="生成器模式"></a>生成器模式</h2><p><strong>意图：</strong>将一个复杂的构建与其表示相分离，使得同样的构建过程可以创建不同的表示。<br><strong>主要解决：</strong>主要解决在软件系统中，有时候面临着”一个复杂对象”的创建工作，其通常由各个部分的子对象用一定的算法构成；由于需求的变化，这个复杂对象的各个部分经常面临着剧烈的变化，但是将它们组合在一起的算法却相对稳定。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/l9O1EoVdSmyiZLw.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">public class TableBuilderDemo &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        (new TableBuilderDemo()).demo(args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Client code perspective.</span><br><span class="line">     */</span><br><span class="line">    public void demo(String[] args) &#123;</span><br><span class="line">        // Name of the GUI table class can be passed to the app parameters.</span><br><span class="line">        String class_name = args.length &gt; 0 ? args[0] : &quot;JTable_Builder&quot;;</span><br><span class="line"></span><br><span class="line">        Builder target = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            target = (Builder) Class.forName(getClass().getName() + &quot;$&quot; + class_name)</span><br><span class="line">                    .getDeclaredConstructor().newInstance();</span><br><span class="line">        &#125; catch (Exception ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String file_name = getClass().getResource(&quot;../BuilderDemo.dat&quot;).getFile();</span><br><span class="line">        TableDirector director = new TableDirector(target);</span><br><span class="line">        director.construct(file_name);</span><br><span class="line">        Component comp = target.get_result();</span><br><span class="line"></span><br><span class="line">        JFrame frame = new JFrame(&quot;BuilderDemo - &quot; + class_name);</span><br><span class="line">        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        frame.getContentPane().add(comp);</span><br><span class="line">        frame.pack();</span><br><span class="line">        frame.setVisible(true);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    interface Builder &#123;</span><br><span class="line">        void set_width_and_height(int width, int height);</span><br><span class="line"></span><br><span class="line">        void start_row();</span><br><span class="line"></span><br><span class="line">        void build_cell(String value);</span><br><span class="line"></span><br><span class="line">        Component get_result();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class JTable_Builder implements Builder &#123;</span><br><span class="line">        private JTable m_table;</span><br><span class="line">        private TableModel m_model;</span><br><span class="line">        private int x = 0, y = 0;</span><br><span class="line"></span><br><span class="line">        public void set_width_and_height(int width, int height) &#123;</span><br><span class="line">            m_table = new JTable(height, width);</span><br><span class="line">            m_model = m_table.getModel();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void start_row() &#123;</span><br><span class="line">            x = 0;</span><br><span class="line">            ++y;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void build_cell(String value) &#123;</span><br><span class="line">            m_model.setValueAt(value, y, x++);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public Component get_result() &#123;</span><br><span class="line">            return m_table;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class GridLayout_Builder implements Builder &#123;</span><br><span class="line">        private JPanel m_panel = new JPanel();</span><br><span class="line"></span><br><span class="line">        public void set_width_and_height(int width, int height) &#123;</span><br><span class="line">            m_panel.setLayout(new GridLayout(height, width));</span><br><span class="line">            m_panel.setBackground(Color.white);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void start_row() &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void build_cell(String value) &#123;</span><br><span class="line">            m_panel.add(new Label(value));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public Component get_result() &#123;</span><br><span class="line">            return m_panel;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class GridBagLayout_Builder implements Builder &#123;</span><br><span class="line">        private JPanel m_panel = new JPanel();</span><br><span class="line">        private GridBagConstraints c = new GridBagConstraints();</span><br><span class="line">        private int x = 0, y = 0;</span><br><span class="line"></span><br><span class="line">        public void set_width_and_height(int width, int height) &#123;</span><br><span class="line">            m_panel.setLayout(new GridBagLayout());</span><br><span class="line">            m_panel.setBackground(Color.white);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void start_row() &#123;</span><br><span class="line">            x = 0;</span><br><span class="line">            ++y;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void build_cell(String value) &#123;</span><br><span class="line">            c.gridx = x++;</span><br><span class="line">            c.gridy = y;</span><br><span class="line">            m_panel.add(new Label(value), c);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public Component get_result() &#123;</span><br><span class="line">            return m_panel;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    class TableDirector &#123;</span><br><span class="line">        private Builder m_builder;</span><br><span class="line"></span><br><span class="line">        public TableDirector(Builder b) &#123;</span><br><span class="line">            m_builder = b;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void construct(String file_name) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                BufferedReader br = new BufferedReader(new FileReader(file_name));</span><br><span class="line">                String line;</span><br><span class="line">                String[] cells;</span><br><span class="line"></span><br><span class="line">                if ((line = br.readLine()) != null) &#123;</span><br><span class="line">                    cells = line.split(&quot;\\t&quot;);</span><br><span class="line">                    int width = Integer.parseInt(cells[0]);</span><br><span class="line">                    int height = Integer.parseInt(cells[1]);</span><br><span class="line">                    m_builder.set_width_and_height(width, height);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                while ((line = br.readLine()) != null) &#123;</span><br><span class="line">                    cells = line.split(&quot;\\t&quot;);</span><br><span class="line">                    for (int col = 0; col &lt; cells.length; ++col) &#123;</span><br><span class="line">                        m_builder.build_cell(cells[col]);</span><br><span class="line">                    &#125;</span><br><span class="line">                    m_builder.start_row();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                br.close();</span><br><span class="line">            &#125; catch (Exception ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES：<a class="link" target="_blank" rel="noopener" href="https://sourcemaking.com/design_patterns/builder/java/1">Builder Pattern - SourceMaking<i class="fas fa-external-link-alt"></i></a></p><h2 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h2><p><strong>意图：</strong>用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。<br><strong>主要解决：</strong>在运行期建立和删除原型。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/Prototype_example1.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/** Prototype Class **/</span><br><span class="line"> public class Cookie implements Cloneable &#123;</span><br><span class="line">    public Object clone() throws CloneNotSupportedException</span><br><span class="line">    &#123;</span><br><span class="line">        //In an actual implementation of this pattern you would now attach references to</span><br><span class="line">        //the expensive to produce parts from the copies that are held inside the prototype.</span><br><span class="line">        return (Cookie) super.clone();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/** Concrete Prototypes to clone **/</span><br><span class="line">public class CoconutCookie extends Cookie &#123; &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">/** Client Class**/</span><br><span class="line"> public class CookieMachine</span><br><span class="line"> &#123;</span><br><span class="line"> </span><br><span class="line">   private Cookie cookie;//cookie必须是可复制的</span><br><span class="line"> </span><br><span class="line">     public CookieMachine(Cookie cookie) &#123; </span><br><span class="line">         this.cookie = cookie; </span><br><span class="line">     &#125; </span><br><span class="line"></span><br><span class="line">    public Cookie makeCookie()</span><br><span class="line">    &#123;</span><br><span class="line">        try</span><br><span class="line">        &#123;</span><br><span class="line">            return (Cookie) cookie.clone();</span><br><span class="line">        &#125; catch (CloneNotSupportedException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">     public static void main(String args[])&#123; </span><br><span class="line">         Cookie tempCookie =  null; </span><br><span class="line">         Cookie prot = new CoconutCookie(); </span><br><span class="line">         CookieMachine cm = new CookieMachine(prot); //设置原型</span><br><span class="line">         for(int i=0; i&lt;100; i++) </span><br><span class="line">             tempCookie = cm.makeCookie();//通过复制原型返回多个cookie </span><br><span class="line">     &#125; </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>REFERENCES：<a class="link" target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F">原型模式-维基百科<i class="fas fa-external-link-alt"></i></a></p><h1 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h1><h2 id="享元模式"><a href="#享元模式" class="headerlink" title="享元模式"></a>享元模式</h2><p><strong>意图：</strong>尽可能减少内存使用量以及分享资讯给尽可能多的相似物件。<br><strong>主要解决：</strong>大量物件只是重复因而导致无法令人接受的使用大量内存。<br><strong>如何解决：</strong>把它们放在外部数据结构，当需要使用时再将它们传递给享元。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public enum FontEffect &#123;</span><br><span class="line">    BOLD, ITALIC, SUPERSCRIPT, SUBSCRIPT, STRIKETHROUGH</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">public final class FontData &#123;</span><br><span class="line">    /**</span><br><span class="line">     * A weak hash map will drop unused references to FontData.</span><br><span class="line">     * Values have to be wrapped in WeakReferences, </span><br><span class="line">     * because value objects in weak hash map are held by strong references.</span><br><span class="line">     * 一个WeakHashMap将自动GC未被引用的FontData</span><br><span class="line">     * 值必须被包裹在WeakReference中</span><br><span class="line">     * 因为值在WeakHashMap中依旧还是强引用状态</span><br><span class="line">     */</span><br><span class="line">    private static final WeakHashMap&lt;FontData, WeakReference&lt;FontData&gt;&gt; FLY_WEIGHT_DATA =</span><br><span class="line">        new WeakHashMap&lt;FontData, WeakReference&lt;FontData&gt;&gt;();</span><br><span class="line">    private final int pointSize;</span><br><span class="line">    private final String fontFace;</span><br><span class="line">    private final Color color;</span><br><span class="line">    private final Set&lt;FontEffect&gt; effects;</span><br><span class="line"></span><br><span class="line">    private FontData(int pointSize, String fontFace, Color color, EnumSet&lt;FontEffect&gt; effects) &#123;</span><br><span class="line">        this.pointSize = pointSize;</span><br><span class="line">        this.fontFace = fontFace;</span><br><span class="line">        this.color = color;</span><br><span class="line">        this.effects = Collections.unmodifiableSet(effects);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static FontData create(int pointSize, String fontFace, Color color,</span><br><span class="line">        FontEffect... effects) &#123;</span><br><span class="line">        EnumSet&lt;FontEffect&gt; effectsSet = EnumSet.noneOf(FontEffect.class);</span><br><span class="line">        for (FontEffect fontEffect : effects) &#123;</span><br><span class="line">            effectsSet.add(fontEffect);</span><br><span class="line">        &#125;</span><br><span class="line">        // We are unconcerned with object creation cost, we are reducing overall memory consumption</span><br><span class="line">        // 我们不关心对象创建成本，我们正在减少总体内存消耗</span><br><span class="line">        FontData data = new FontData(pointSize, fontFace, color, effectsSet);</span><br><span class="line"></span><br><span class="line">        // Retrieve previously created instance with the given values if it (still) exists</span><br><span class="line">        //如果（仍然）存在，则使用给定值检索先前创建的实例</span><br><span class="line">        WeakReference&lt;FontData&gt; ref = FLY_WEIGHT_DATA.get(data);</span><br><span class="line">        FontData result = (ref != null) ? ref.get() : null;</span><br><span class="line">        </span><br><span class="line">        // Store new font data instance if no matching instance exists</span><br><span class="line">        // 如果不存在匹配的实例，则存储新的FontData实例</span><br><span class="line">        if (result == null) &#123;</span><br><span class="line">            FLY_WEIGHT_DATA.put(data, new WeakReference&lt;FontData&gt; (data));</span><br><span class="line">            result = data;</span><br><span class="line">        &#125;</span><br><span class="line">        // return the single immutable copy with the given values</span><br><span class="line">        // 返回具有给定值的单个不可变副本</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean equals(Object obj) &#123;</span><br><span class="line">        if (obj instanceof FontData) &#123;</span><br><span class="line">            if (obj == this) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">            FontData other = (FontData) obj;</span><br><span class="line">            return other.pointSize == pointSize &amp;&amp; other.fontFace.equals(fontFace)</span><br><span class="line">                &amp;&amp; other.color.equals(color) &amp;&amp; other.effects.equals(effects);</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int hashCode() &#123;</span><br><span class="line">        return (pointSize * 37 + effects.hashCode() * 13) * fontFace.hashCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Getters for the font data, but no setters. FontData is immutable.</span><br><span class="line">    // 获取FontData的getters，但没有setter。 FontData是不可变的。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>总结：</strong>享元模式通过共用对象的方式 来减少数据对象的创建 减少内存的使用</p></blockquote><h2 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h2><p><strong>意图：</strong>为其他对象提供一种代理以控制对这个对象的访问。<br><strong>主要解决：</strong>在直接访问对象时带来的问题，比如说：要访问的对象在远程的机器上。在面向对象系统中，有些对象由于某些原因（比如对象创建开销很大，或者某些操作需要安全控制，或者需要进程外的访问），直接访问会给使用者或者系统结构带来很多麻烦，我们可以在访问此对象时加上一个对此对象的访问层。<br><strong>何时使用：</strong>想在访问一个类时做一些控制。<br><strong>如何解决：</strong>增加中间层。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/proxy_pattern_uml_diagram.jpg"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface Image &#123;</span><br><span class="line">    public void displayImage();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//on System A </span><br><span class="line">class RealImage implements Image &#123;</span><br><span class="line">    private String filename;</span><br><span class="line">    public RealImage(String filename) &#123; </span><br><span class="line">        this.filename = filename;</span><br><span class="line">        loadImageFromDisk();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void loadImageFromDisk() &#123;</span><br><span class="line">        System.out.println(&quot;Loading   &quot; + filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void displayImage() &#123; </span><br><span class="line">        System.out.println(&quot;Displaying &quot; + filename); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//on System B </span><br><span class="line">class ProxyImage implements Image &#123;</span><br><span class="line">    private String filename;</span><br><span class="line">    private Image image;</span><br><span class="line"> </span><br><span class="line">    public ProxyImage(String filename) &#123; </span><br><span class="line">        this.filename = filename; </span><br><span class="line">    &#125;</span><br><span class="line">    public void displayImage() &#123;</span><br><span class="line">        if(image == null)</span><br><span class="line">              image = new RealImage(filename);</span><br><span class="line">        image.displayImage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class ProxyExample &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Image image1 = new ProxyImage(&quot;HiRes_10MB_Photo1&quot;);</span><br><span class="line">        Image image2 = new ProxyImage(&quot;HiRes_10MB_Photo2&quot;);</span><br><span class="line"></span><br><span class="line">        image1.displayImage(); // loading necessary</span><br><span class="line">        image2.displayImage(); // loading necessary</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>总结：<br>优点： 1、职责清晰。 2、高扩展性。 3、智能化。<br>缺点： 1、由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。 2、实现代理模式需要额外的工作，有些代理模式的实现非常复杂。</p></blockquote><h2 id="外观模式"><a href="#外观模式" class="headerlink" title="外观模式"></a>外观模式</h2><p><strong>意图：</strong>为子系统中的一组接口提供一个一致的界面，外观模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。<br><strong>主要解决：</strong>降低访问复杂系统的内部子系统时的复杂度，简化客户端与之的接口。<br><strong>何时使用：</strong> 1、客户端不需要知道系统内部的复杂联系，整个系统只需提供一个”接待员”即可。 2、定义系统的入口。<br><strong>如何解决：</strong>客户端不与系统耦合，外观类与系统耦合。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/9MJ3FbDEISiqOre.png"></p><blockquote><p>Facade<br>这个外观类为子系统中Packages 1、2、3提供一个共同的对外接口<br>Clients<br>客户对象通过一个外观接口读写子系统中各接口的数据资源。<br>Packages<br>客户可以通过外观接口读取的内部库。</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/* Complex parts */</span><br><span class="line"></span><br><span class="line">class CPU &#123;</span><br><span class="line">    public void freeze() &#123; ... &#125;</span><br><span class="line">    public void jump(long position) &#123; ... &#125;</span><br><span class="line">    public void execute() &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Memory &#123;</span><br><span class="line">    public void load(long position, byte[] data) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class HardDrive &#123;</span><br><span class="line">    public byte[] read(long lba, int size) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/* Façade */</span><br><span class="line"></span><br><span class="line">class Computer &#123;</span><br><span class="line">    public void startComputer() &#123;</span><br><span class="line">        cpu.freeze();</span><br><span class="line">        memory.load(BOOT_ADDRESS, hardDrive.read(BOOT_SECTOR, SECTOR_SIZE));</span><br><span class="line">        cpu.jump(BOOT_ADDRESS);</span><br><span class="line">        cpu.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* Client */</span><br><span class="line"></span><br><span class="line">class You &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Computer facade = new Computer();</span><br><span class="line">        facade.startComputer();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>总结：<br>优点： 1、减少系统相互依赖。 2、提高灵活性。 3、提高了安全性。<br>缺点：不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。</p></blockquote><h2 id="修饰模式"><a href="#修饰模式" class="headerlink" title="修饰模式"></a>修饰模式</h2><p><strong>意图：</strong>动态地给一个对象添加一些额外的职责。就增加功能来说，装饰器模式相比生成子类更为灵活。<br><strong>主要解决：</strong>一般的，我们为了扩展一个类经常使用继承方式实现，由于继承为类引入静态特征，并且随着扩展功能的增多，子类会很膨胀。<br><strong>何时使用：</strong>在不想增加很多子类的情况下扩展类。<br><strong>如何解决：</strong>将具体功能职责划分，同时继承装饰者模式。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/9e6AiXqlunaZGzN.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// The Window interface class</span><br><span class="line">public interface Window &#123;</span><br><span class="line">    // Draws the Window</span><br><span class="line">    public void draw(); </span><br><span class="line">    // Returns a description of the Window</span><br><span class="line">    public String getDescription(); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// implementation of a simple Window without any scrollbars</span><br><span class="line">public class SimpleWindow implements Window &#123;</span><br><span class="line">    public void draw() &#123;</span><br><span class="line">        // Draw window</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getDescription() &#123;</span><br><span class="line">        return &quot;simple window&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">// abstract decorator class - note that it implements Window</span><br><span class="line">public abstract class WindowDecorator implements Window &#123;</span><br><span class="line">    protected Window decoratedWindow; // the Window being decorated</span><br><span class="line"></span><br><span class="line">    public WindowDecorator (Window decoratedWindow) &#123;</span><br><span class="line">        this.decoratedWindow = decoratedWindow;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public void draw() &#123;</span><br><span class="line">        decoratedWindow.draw();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getDescription() &#123;</span><br><span class="line">        return decoratedWindow.getDescription();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// The first concrete decorator which adds vertical scrollbar functionality</span><br><span class="line">public class VerticalScrollBar extends WindowDecorator &#123;</span><br><span class="line">    public VerticalScrollBar(Window windowToBeDecorated) &#123;</span><br><span class="line">        super(windowToBeDecorated);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void draw() &#123;</span><br><span class="line">        super.draw();</span><br><span class="line">        drawVerticalScrollBar();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void drawVerticalScrollBar() &#123;</span><br><span class="line">        // Draw the vertical scrollbar</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getDescription() &#123;</span><br><span class="line">        return super.getDescription() + &quot;, including vertical scrollbars&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// The second concrete decorator which adds horizontal scrollbar functionality</span><br><span class="line">public class HorizontalScrollBar extends WindowDecorator &#123;</span><br><span class="line">    public HorizontalScrollBar (Window windowToBeDecorated) &#123;</span><br><span class="line">        super(windowToBeDecorated);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void draw() &#123;</span><br><span class="line">        super.draw();</span><br><span class="line">        drawHorizontalScrollBar();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void drawHorizontalScrollBar() &#123;</span><br><span class="line">        // Draw the horizontal scrollbar</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getDescription() &#123;</span><br><span class="line">        return super.getDescription() + &quot;, including horizontal scrollbars&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class Main &#123;</span><br><span class="line">    // for print descriptions of the window subclasses</span><br><span class="line">    static void printInfo(Window w) &#123;</span><br><span class="line">        System.out.println(&quot;description:&quot;+w.getDescription());</span><br><span class="line">    &#125;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        // original SimpleWindow</span><br><span class="line">        SimpleWindow sw = new SimpleWindow();</span><br><span class="line">        printInfo(sw);</span><br><span class="line">        // HorizontalScrollBar  mixed Window</span><br><span class="line">        HorizontalScrollBar hbw = new HorizontalScrollBar(sw);</span><br><span class="line">        printInfo(hbw);</span><br><span class="line">        // VerticalScrollBar mixed Window</span><br><span class="line">        VerticalScrollBar vbw = new VerticalScrollBar(hbw);</span><br><span class="line">        printInfo(vbw);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="桥接模式"><a href="#桥接模式" class="headerlink" title="桥接模式"></a>桥接模式</h2><p><strong>意图：</strong>将抽象部分与实现部分分离，使它们都可以独立的变化。<br><strong>主要解决：</strong>在有多种可能会变化的情况下，用继承会造成类爆炸问题，扩展起来不灵活。<br><strong>何时使用：</strong>实现系统可能有多个角度分类，每一种角度都可能变化。<br><strong>如何解决：</strong>把这种多角度分类分离出来，让它们独立变化，减少它们之间耦合。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/9LBkW7Rpj8ryqCN.png"></p><ul><li>Abstraction<br>定义抽象的接口<br>该接口包含实现具体行为、具体特征的Implementor接口</li><li>Refined Abstraction<br>抽象接口Abstraction的子类，依旧是一个抽象的事物名</li><li>Implementor<br>定义具体行为、具体特征的应用接口</li><li>ConcreteImplementor<br>实现Implementor接口</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/** &quot;Implementor&quot; */</span><br><span class="line">interface DrawingAPI&#123;</span><br><span class="line">    public void drawCircle(double x, double y, double radius);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/** &quot;ConcreteImplementor&quot; 1/2 */</span><br><span class="line">class DrawingAPI1 implements DrawingAPI&#123;</span><br><span class="line">   public void drawCircle(double x, double y, double radius)&#123;</span><br><span class="line">        System.out.printf(&quot;API1.circle at %f:%f radius %f\n&quot;, x, y, radius);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** &quot;ConcreteImplementor&quot; 2/2 */</span><br><span class="line">class DrawingAPI2 implements DrawingAPI&#123;</span><br><span class="line">   public void drawCircle(double x, double y, double radius)&#123; </span><br><span class="line">        System.out.printf(&quot;API2.circle at %f:%f radius %f\n&quot;, x, y, radius);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/** &quot;Abstraction&quot; */</span><br><span class="line">interface Shape&#123;</span><br><span class="line">   public void draw();// low-level</span><br><span class="line">   public void resizeByPercentage(double pct);// high-level</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/** &quot;Refined Abstraction&quot; */</span><br><span class="line">class CircleShape implements Shape</span><br><span class="line">&#123;</span><br><span class="line">   private double x, y, radius;</span><br><span class="line">   private DrawingAPI drawingAPI;</span><br><span class="line">   public CircleShape(double x, double y, double radius, DrawingAPI drawingAPI)</span><br><span class="line">   &#123;</span><br><span class="line">       this.x = x;  this.y = y;  this.radius = radius; </span><br><span class="line">       this.drawingAPI = drawingAPI;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   // low-level i.e. Implementation specific</span><br><span class="line">   public void draw()</span><br><span class="line">   &#123;</span><br><span class="line">        drawingAPI.drawCircle(x, y, radius);</span><br><span class="line">   &#125;   </span><br><span class="line">   // high-level i.e. Abstraction specific</span><br><span class="line">   public void resizeByPercentage(double pct)</span><br><span class="line">   &#123;</span><br><span class="line">        radius *= pct;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/** &quot;Client&quot; */</span><br><span class="line">class BridgePattern &#123;</span><br><span class="line">   public static void main(String[] args)</span><br><span class="line">   &#123;</span><br><span class="line">       Shape[] shapes = new Shape[2];</span><br><span class="line">       shapes[0] = new CircleShape(1, 2, 3, new DrawingAPI1());</span><br><span class="line">       shapes[1] = new CircleShape(5, 7, 11, new DrawingAPI2());</span><br><span class="line"></span><br><span class="line">       for (Shape shape : shapes)</span><br><span class="line">       &#123;</span><br><span class="line">           shape.resizeByPercentage(2.5);</span><br><span class="line">           shape.draw();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES: <a class="link" target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%A9%8B%E6%8E%A5%E6%A8%A1%E5%BC%8F">维基百科-桥接模式<i class="fas fa-external-link-alt"></i></a></p><h2 id="适配器模式"><a href="#适配器模式" class="headerlink" title="适配器模式"></a>适配器模式</h2><p><strong>意图：</strong>将一个类的接口转换成客户希望的另外一个接口。适配器模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。<br><strong>主要解决：</strong>主要解决在软件系统中，常常要将一些”现存的对象”放到新的环境中，而新环境要求的接口是现对象不能满足的。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/Adapter.png"></p><p><strong>Code:</strong><br><img lazyload alt="image" data-src="https://sourcemaking.com/files/v2/content/patterns/Adapter_1.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//定义目标调用接口</span><br><span class="line">interface Shape &#123;</span><br><span class="line">    void draw(int x, int y, int z, int j);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class Line &#123;</span><br><span class="line">    public void draw(int x1, int y1, int x2, int y2) &#123;</span><br><span class="line">        System.out.println(&quot;Line from point A(&quot; + x1 + &quot;;&quot; + y1 + &quot;), to point B(&quot; + x2 + &quot;;&quot; + y2 + &quot;)&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Rectangle &#123;</span><br><span class="line">    public void draw(int x, int y, int width, int height) &#123;</span><br><span class="line">        System.out.println(&quot;Rectangle with coordinate left-down point (&quot; + x + &quot;;&quot; + y + &quot;), width: &quot; + width</span><br><span class="line">                + &quot;, height: &quot; + height);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//实现Adapter</span><br><span class="line">class LineAdapter implements Shape &#123;</span><br><span class="line">    private Line adaptee;</span><br><span class="line"></span><br><span class="line">    public LineAdapter(Line line) &#123;</span><br><span class="line">        this.adaptee = line;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void draw(int x1, int y1, int x2, int y2) &#123;</span><br><span class="line">        adaptee.draw(x1, y1, x2, y2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class RectangleAdapter implements Shape &#123;</span><br><span class="line">    private Rectangle adaptee;</span><br><span class="line"></span><br><span class="line">    public RectangleAdapter(Rectangle rectangle) &#123;</span><br><span class="line">        this.adaptee = rectangle;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void draw(int x1, int y1, int x2, int y2) &#123;</span><br><span class="line">        int x = Math.min(x1, x2);</span><br><span class="line">        int y = Math.min(y1, y2);</span><br><span class="line">        int width = Math.abs(x2 - x1);</span><br><span class="line">        int height = Math.abs(y2 - y1);</span><br><span class="line">        adaptee.draw(x, y, width, height);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//目标类的调用</span><br><span class="line">public class AdapterDemo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Shape[] shapes = &#123;new RectangleAdapter(new Rectangle()),</span><br><span class="line">                          new LineAdapter(new Line())&#125;;</span><br><span class="line">        int x1 = 10, y1 = 20;</span><br><span class="line">        int x2 = 30, y2 = 60;</span><br><span class="line">        for (Shape shape : shapes) &#123;</span><br><span class="line">            shape.draw(x1, y1, x2, y2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCE：<a class="link" target="_blank" rel="noopener" href="https://sourcemaking.com/design_patterns/adapter/java/1">Adapter Pattern - SourceMaking<i class="fas fa-external-link-alt"></i></a></p><h1 id="行为型模式"><a href="#行为型模式" class="headerlink" title="行为型模式"></a>行为型模式</h1><h2 id="访问者模式"><a href="#访问者模式" class="headerlink" title="访问者模式"></a>访问者模式</h2><p><strong>意图：</strong>主要将数据结构与数据操作分离。<br><strong>主要解决：</strong>稳定的数据结构和易变的操作耦合问题。<br><strong>何时使用：</strong>需要对一个对象结构中的对象进行很多不同的并且不相关的操作，而需要避免让这些操作”污染”这些对象的类，使用访问者模式将这些封装到类中。<br><strong>如何解决：</strong>在被访问的类里面加一个对外提供接待访问者的接口。</p><p><strong>图示：</strong><br><img lazyload alt="image" data-src="/images/design-pattern/Visitor1.png" alt="Visitor scheme"></p><p><strong>Code:</strong></p><ol><li>Add an <code>accept(Visitor)</code> method to the “element” hierarchy</li><li>Create a “visitor” base class w&#x2F; a <code>visit()</code> method for every “element” type</li><li>Create a “visitor” derived class for each “operation” to do on “elements”</li><li>Client creates “visitor” objects and passes each to <code>accept()</code> calls</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//创建对象访问回调接口</span><br><span class="line">interface Element &#123;</span><br><span class="line">    void accept(Visitor v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class FOO implements Element &#123;</span><br><span class="line">    public void accept(Visitor v) &#123;</span><br><span class="line">        v.visit(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getFOO() &#123;</span><br><span class="line">        return &quot;FOO&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class BAR implements Element &#123;</span><br><span class="line">    public void   accept( Visitor v ) &#123;</span><br><span class="line">        v.visit( this );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getBAR() &#123;</span><br><span class="line">        return &quot;BAR&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface Visitor &#123;</span><br><span class="line">    void visit(FOO foo);</span><br><span class="line">    void visit(BAR bar);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//创建访问者对象实例</span><br><span class="line">class UpVisitor implements Visitor &#123;</span><br><span class="line">    public void visit(FOO foo) &#123;</span><br><span class="line">        System.out.println(&quot;do Up on &quot; + foo.getFOO());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void visit(BAR bar) &#123;</span><br><span class="line">        System.out.println(&quot;do Up on &quot; + bar.getBAR());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DownVisitor implements Visitor &#123;</span><br><span class="line">    public void visit(FOO foo) &#123;</span><br><span class="line">        System.out.println(&quot;do Down on &quot; + foo.getFOO());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void visit(BAR bar) &#123;</span><br><span class="line">        System.out.println(&quot;do Down on &quot; + bar.getBAR());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//Client 进行访问</span><br><span class="line">public class VisitorDemo &#123;</span><br><span class="line">    public static void main( String[] args ) &#123;</span><br><span class="line">        Element[] list = &#123;new FOO(), new BAR()&#125;;</span><br><span class="line">        UpVisitor up = new UpVisitor();</span><br><span class="line">        DownVisitor down = new DownVisitor();</span><br><span class="line">        for (Element element : list) &#123;</span><br><span class="line">            element.accept(up);</span><br><span class="line">        &#125;</span><br><span class="line">        for (Element element : list) &#123;</span><br><span class="line">            element.accept(down);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES：<a class="link" target="_blank" rel="noopener" href="https://sourcemaking.com/design_patterns/visitor/java/1">Visitor Design Pattern<i class="fas fa-external-link-alt"></i></a></p><h2 id="模板方法模式"><a href="#模板方法模式" class="headerlink" title="模板方法模式"></a>模板方法模式</h2><p><strong>意图：</strong>定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。模板方法使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。<br><strong>主要解决：</strong>一些方法通用，却在每一个子类都重新写了这一方法。<br><strong>何时使用：</strong>有一些通用的方法。<br><strong>如何解决：</strong>将这些通用算法抽象出来。</p><p>图示：<br><img lazyload alt="image" data-src="/images/design-pattern/Template_method_example.png" alt="Template Method example"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">abstract class Game &#123;</span><br><span class="line">    private int playersCount;</span><br><span class="line">    abstract void initializeGame();</span><br><span class="line">    abstract void makePlay(int player);</span><br><span class="line">    abstract boolean endOfGame();</span><br><span class="line">    abstract void printWinner();</span><br><span class="line"></span><br><span class="line">    /* A template method : */</span><br><span class="line">    final void playOneGame(int playersCount) &#123;</span><br><span class="line">        this.playersCount = playersCount;</span><br><span class="line">        initializeGame();</span><br><span class="line">        int j = 0;</span><br><span class="line">        while (!endOfGame())&#123;</span><br><span class="line">            makePlay(j);</span><br><span class="line">            j = (j + 1) % playersCount;</span><br><span class="line">        &#125;</span><br><span class="line">        printWinner();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//Now we can extend this class in order to implement actual games:</span><br><span class="line"></span><br><span class="line"> class Monopoly extends Game &#123;</span><br><span class="line">     /* Implementation of necessary concrete methods */</span><br><span class="line">     void initializeGame() &#123;/* ...*/ &#125;</span><br><span class="line">     void makePlay(int player) &#123;/* ...*/&#125;</span><br><span class="line">     boolean endOfGame() &#123;/* ...*/&#125;</span><br><span class="line">     void printWinner() &#123; /* ...*/&#125;</span><br><span class="line">     /* Specific declarations for the Monopoly game. */</span><br><span class="line">     // ...</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> class Chess extends Game &#123;</span><br><span class="line">     /* Implementation of necessary concrete methods */</span><br><span class="line">     void initializeGame() &#123;/* ...*/&#125;</span><br><span class="line">     void makePlay(int player) &#123;/* ...*/&#125;</span><br><span class="line">     boolean endOfGame() &#123;/* ... */&#125;</span><br><span class="line">     void printWinner() &#123;/* ...*/&#125;</span><br><span class="line">     /* Specific declarations for the chess game. */</span><br><span class="line">     // ...</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Player &#123;</span><br><span class="line">     public static void main(String[] args) &#123;</span><br><span class="line">         Game chessGame = new Chess();</span><br><span class="line">         chessGame.initializeGame();</span><br><span class="line">         chessGame.playOneGame(1); //call template method</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>REFERENCES：<a class="link" target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95">模板方法 - 维基百科<i class="fas fa-external-link-alt"></i></a></p><h2 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h2><p><strong>意图：</strong>定义一系列的算法,把它们一个个封装起来, 并且使它们可相互替换。<br><strong>主要解决：</strong>在有多种算法相似的情况下，使用 if…else 所带来的复杂和难以维护。<br><strong>何时使用：</strong>一个系统有许多许多类，而区分它们的只是他们直接的行为。<br><strong>如何解决：</strong>将这些算法封装成一个一个的类，任意地替换。</p><p>图示：<br><img lazyload alt="image" data-src="/images/design-pattern/Strategy_.png" alt="Strategy scheme"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// The context class uses this to call the concrete strategy</span><br><span class="line">interface Strategy &#123;</span><br><span class="line">    void execute();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// Implements the algorithm using the strategy interface</span><br><span class="line">class FirstStrategy implements Strategy &#123;</span><br><span class="line">    public void execute() &#123;</span><br><span class="line">        System.out.println(&quot;Called FirstStrategy.execute()&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class SecondStrategy implements Strategy &#123;</span><br><span class="line">    public void execute() &#123;</span><br><span class="line">        System.out.println(&quot;Called SecondStrategy.execute()&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ThirdStrategy implements Strategy &#123;</span><br><span class="line">    public void execute() &#123;</span><br><span class="line">        System.out.println(&quot;Called ThirdStrategy.execute()&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// Configured with a ConcreteStrategy object and maintains a reference to a Strategy object</span><br><span class="line">class Context &#123;</span><br><span class="line"></span><br><span class="line">    Strategy strategy;</span><br><span class="line"></span><br><span class="line">    // Constructor</span><br><span class="line">    public Context(Strategy strategy) &#123;</span><br><span class="line">        this.strategy = strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void execute() &#123;</span><br><span class="line">        this.strategy.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class StrategyExample &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        Context context;</span><br><span class="line"></span><br><span class="line">        // Three contexts following different strategies</span><br><span class="line">        context = new Context(new FirstStrategy());</span><br><span class="line">        context.execute();</span><br><span class="line"></span><br><span class="line">        context = new Context(new SecondStrategy());</span><br><span class="line">        context.execute();</span><br><span class="line"></span><br><span class="line">        context = new Context(new ThirdStrategy());</span><br><span class="line">        context.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES：<a class="link" target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F">策略模式 - 维基百科<i class="fas fa-external-link-alt"></i></a></p><h2 id="状态模式"><a href="#状态模式" class="headerlink" title="状态模式"></a>状态模式</h2><p><strong>意图：</strong>允许对象在内部状态发生改变时改变它的行为，对象看起来好像修改了它的类。<br><strong>主要解决：</strong>对象的行为依赖于它的状态（属性），并且可以根据它的状态改变而改变它的相关行为。<br><strong>何时使用：</strong>代码中包含大量与对象状态有关的条件语句。<br><strong>如何解决：</strong>将各种具体的状态类抽象出来。</p><p>图示：<br><img lazyload alt="image" data-src="/images/design-pattern/State1.png" alt="State scheme"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface State &#123;</span><br><span class="line">    void pull(CeilingFanPullChain wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class CeilingFanPullChain &#123;</span><br><span class="line">    private State currentState;</span><br><span class="line"></span><br><span class="line">    public CeilingFanPullChain() &#123;</span><br><span class="line">        currentState = new Off();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void set_state(State s) &#123;</span><br><span class="line">        currentState = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void pull() &#123;</span><br><span class="line">        currentState.pull(this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class Off implements State &#123;</span><br><span class="line">    public void pull(CeilingFanPullChain wrapper) &#123;</span><br><span class="line">        wrapper.set_state(new Low());</span><br><span class="line">        System.out.println(&quot;low speed&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Low implements State &#123;</span><br><span class="line">    public void pull(CeilingFanPullChain wrapper) &#123;</span><br><span class="line">        wrapper.set_state(new Medium());</span><br><span class="line">        System.out.println(&quot;medium speed&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Medium implements State &#123;</span><br><span class="line">    public void pull(CeilingFanPullChain wrapper) &#123;</span><br><span class="line">        wrapper.set_state(new High());</span><br><span class="line">        System.out.println(&quot;high speed&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class High implements State &#123;</span><br><span class="line">    public void pull(CeilingFanPullChain wrapper) &#123;</span><br><span class="line">        wrapper.set_state(new Off());</span><br><span class="line">        System.out.println(&quot;turning off&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class StateDemo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        CeilingFanPullChain chain = new CeilingFanPullChain();</span><br><span class="line">        while (true) &#123;</span><br><span class="line">            System.out.print(&quot;Press ENTER&quot;);</span><br><span class="line">            getLine();</span><br><span class="line">            chain.pull();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static String getLine() &#123;</span><br><span class="line">        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));</span><br><span class="line">        String line = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            line = in.readLine();</span><br><span class="line">        &#125; catch (IOException ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return line;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES: <a class="link" target="_blank" rel="noopener" href="https://sourcemaking.com/design_patterns/state/java/1">State Design Pattern - SourceMaking<i class="fas fa-external-link-alt"></i></a></p><h2 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h2><p><strong>意图：</strong>定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。<br><strong>主要解决：</strong>一个对象状态改变给其他对象通知的问题，而且要考虑到易用和低耦合，保证高度的协作。<br><strong>何时使用：</strong>一个对象（目标对象）的状态发生改变，所有的依赖对象（观察者对象）都将得到通知，进行广播通知。<br><strong>如何解决：</strong>使用面向对象技术，可以将这种依赖关系弱化。</p><p>图示：<br><img lazyload alt="image" data-src="/images/design-pattern/Observer.png" alt="Observer scheme"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//定义观察者父类</span><br><span class="line">abstract class Observer &#123;</span><br><span class="line">    protected Subject subject;</span><br><span class="line">    public abstract void update();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">class Subject &#123;</span><br><span class="line">    private List&lt;Observer&gt; observers = new ArrayList&lt;&gt;();</span><br><span class="line">    private int state;</span><br><span class="line"></span><br><span class="line">    public void add(Observer o) &#123;</span><br><span class="line">        observers.add(o);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getState() &#123;</span><br><span class="line">        return state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setState(int value) &#123;</span><br><span class="line">        this.state = value;</span><br><span class="line">        execute();</span><br><span class="line">    &#125;</span><br><span class="line">    //在更新后通知观察者</span><br><span class="line">    private void execute() &#123;</span><br><span class="line">        for (Observer observer : observers) &#123;</span><br><span class="line">            observer.update();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">class HexObserver extends Observer &#123;</span><br><span class="line">    public HexObserver(Subject subject) &#123;</span><br><span class="line">        this.subject = subject;</span><br><span class="line">        this.subject.add(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void update() &#123;</span><br><span class="line">        System.out.print(&quot; &quot; + Integer.toHexString(subject.getState()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class OctObserver extends Observer &#123;</span><br><span class="line">    public OctObserver(Subject subject) &#123;</span><br><span class="line">        this.subject = subject;</span><br><span class="line">        this.subject.add( this );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void update() &#123;</span><br><span class="line">        System.out.print(&quot; &quot; + Integer.toOctalString(subject.getState()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class BinObserver extends Observer &#123;</span><br><span class="line">    public BinObserver(Subject subject) &#123;</span><br><span class="line">        this.subject = subject;</span><br><span class="line">        this.subject.add(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void update() &#123;</span><br><span class="line">        System.out.print(&quot; &quot; + Integer.toBinaryString(subject.getState()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class ObserverDemo &#123;</span><br><span class="line">    public static void main( String[] args ) &#123;</span><br><span class="line">        Subject sub = new Subject();</span><br><span class="line">        // Client configures the number and type of Observers</span><br><span class="line">        new HexObserver(sub);</span><br><span class="line">        new OctObserver(sub);</span><br><span class="line">        new BinObserver(sub);</span><br><span class="line">        Scanner scan = new Scanner(System.in);</span><br><span class="line">        for (int i = 0; i &lt; 5; i++) &#123;</span><br><span class="line">            System.out.print(&quot;\nEnter a number: &quot;);</span><br><span class="line">            sub.setState(scan.nextInt());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES: <a class="link" target="_blank" rel="noopener" href="https://sourcemaking.com/design_patterns/observer">Observer Design Pattern<i class="fas fa-external-link-alt"></i></a></p><h2 id="备忘录模式"><a href="#备忘录模式" class="headerlink" title="备忘录模式"></a>备忘录模式</h2><p><strong>意图：</strong>在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。<br><strong>主要解决：</strong>所谓备忘录模式就是在不破坏封装的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样可以在以后将对象恢复到原先保存的状态。<br><strong>何时使用：</strong>很多时候我们总是需要记录一个对象的内部状态，这样做的目的就是为了允许用户取消不确定或者错误的操作，能够恢复到他原先的状态，使得他有”后悔药”可吃。<br><strong>如何解决：</strong>通过一个备忘录类专门存储对象状态。</p><p>图示：<br><img lazyload alt="image" data-src="/images/design-pattern/Memento.png" alt="Memento scheme"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class Memento &#123;</span><br><span class="line">    private String state;</span><br><span class="line"></span><br><span class="line">    public Memento(String state) &#123;</span><br><span class="line">        this.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getState() &#123;</span><br><span class="line">        return state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class Originator &#123;</span><br><span class="line">    private String state;</span><br><span class="line">   /* lots of memory consumptive private data that is not necessary to define the</span><br><span class="line">    * state and should thus not be saved. Hence the small memento object. */</span><br><span class="line"></span><br><span class="line">    public void setState(String state) &#123;</span><br><span class="line">        System.out.println(&quot;Originator: Setting state to &quot; + state);</span><br><span class="line">        this.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Memento save() &#123;</span><br><span class="line">        System.out.println(&quot;Originator: Saving to Memento.&quot;);</span><br><span class="line">        return new Memento(state);</span><br><span class="line">    &#125;</span><br><span class="line">    public void restore(Memento m) &#123;</span><br><span class="line">        state = m.getState();</span><br><span class="line">        System.out.println(&quot;Originator: State after restoring from Memento: &quot; + state);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class Caretaker &#123;</span><br><span class="line">    private ArrayList&lt;Memento&gt; mementos = new ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    public void addMemento(Memento m) &#123;</span><br><span class="line">        mementos.add(m);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Memento getMemento(int index) &#123;</span><br><span class="line">        return mementos.get(index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES：<a class="link" target="_blank" rel="noopener" href="https://sourcemaking.com/design_patterns/memento/java/1">Memento Design Pattern<i class="fas fa-external-link-alt"></i></a></p><h2 id="中介者模式"><a href="#中介者模式" class="headerlink" title="中介者模式"></a>中介者模式</h2><p><strong>意图：</strong>用一个中介对象来封装一系列的对象交互，中介者使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。<br><strong>主要解决：</strong>对象与对象之间存在大量的关联关系，这样势必会导致系统的结构变得很复杂，同时若一个对象发生改变，我们也需要跟踪与之相关联的对象，同时做出相应的处理。<br><strong>何时使用：</strong>多个类相互耦合，形成了网状结构。<br><strong>如何解决：</strong>将上述网状结构分离为星型结构。</p><p>图示：<br><img lazyload alt="image" data-src="/images/design-pattern/Mediator__1.png" alt="Mediator scheme"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// 1. The &quot;intermediary&quot;</span><br><span class="line">class Mediator &#123;</span><br><span class="line">    // 4. The Mediator arbitrates</span><br><span class="line">    private boolean slotFull = false;</span><br><span class="line">    private int number;</span><br><span class="line"></span><br><span class="line">    public synchronized void storeMessage(int num) &#123;</span><br><span class="line">        // no room for another message</span><br><span class="line">        while (slotFull == true) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                wait();</span><br><span class="line">            &#125;</span><br><span class="line">            catch (InterruptedException e ) &#123;</span><br><span class="line">                Thread.currentThread().interrupt();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        slotFull = true;</span><br><span class="line">        number = num;</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public synchronized int retrieveMessage() &#123;</span><br><span class="line">        // no message to retrieve</span><br><span class="line">        while (slotFull == false) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                wait();</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                Thread.currentThread().interrupt();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        slotFull = false;</span><br><span class="line">        notifyAll();</span><br><span class="line">        return number;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">class Producer implements Runnable &#123;</span><br><span class="line">    // 2. Producers are coupled only to the Mediator</span><br><span class="line">    private Mediator med;</span><br><span class="line">    private int id;</span><br><span class="line">    private static int num = 1;</span><br><span class="line"></span><br><span class="line">    public Producer(Mediator m) &#123;</span><br><span class="line">        med = m;</span><br><span class="line">        id = num++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        int num;</span><br><span class="line">        while (true) &#123;</span><br><span class="line">            med.storeMessage(num = (int)(Math.random()*100));</span><br><span class="line">            System.out.print( &quot;p&quot; + id + &quot;-&quot; + num + &quot;  &quot; );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class Consumer implements Runnable &#123;</span><br><span class="line">    // 3. Consumers are coupled only to the Mediator</span><br><span class="line">    private Mediator med;</span><br><span class="line">    private int    id;</span><br><span class="line">    private static int num = 1;</span><br><span class="line"></span><br><span class="line">    public Consumer(Mediator m) &#123;</span><br><span class="line">        med = m;</span><br><span class="line">        id = num++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while (true) &#123;</span><br><span class="line">            System.out.print(&quot;c&quot; + id + &quot;-&quot; + med.retrieveMessage() + &quot;  &quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public class MediatorDemo &#123;</span><br><span class="line">    public static void main( String[] args ) &#123;</span><br><span class="line">        List&lt;Thread&gt; producerList = new ArrayList&lt;&gt;();</span><br><span class="line">        Scanner scanner = new Scanner(System.in);</span><br><span class="line">        System.out.println(&quot;Press ENTER for exit&quot;);</span><br><span class="line">        Mediator mb = new Mediator();</span><br><span class="line">        producerList.add(new Thread(new Producer(mb)));</span><br><span class="line">        producerList.add(new Thread(new Producer(mb)));</span><br><span class="line">        producerList.add(new Thread(new Consumer(mb)));</span><br><span class="line">        producerList.add(new Thread(new Consumer(mb)));</span><br><span class="line">        producerList.add(new Thread(new Consumer(mb)));</span><br><span class="line">        producerList.add(new Thread(new Consumer(mb)));</span><br><span class="line">        for (Thread p : producerList) &#123;</span><br><span class="line">            p.start();</span><br><span class="line">        &#125;</span><br><span class="line">        boolean stop = false;</span><br><span class="line">        String exit = scanner.nextLine();</span><br><span class="line">        while (!stop) &#123;</span><br><span class="line">            if (exit.equals(&quot;&quot;)) &#123;</span><br><span class="line">                stop = true;</span><br><span class="line">                for (Thread p : producerList) &#123;</span><br><span class="line">                    //noinspection deprecation</span><br><span class="line">                    p.stop();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES: <a class="link" target="_blank" rel="noopener" href="https://sourcemaking.com/design_patterns/mediator/java/2">Mediator Design Pattern <i class="fas fa-external-link-alt"></i></a></p><h2 id="解释器模式"><a href="#解释器模式" class="headerlink" title="解释器模式"></a>解释器模式</h2><p><strong>意图：</strong>给定一个语言，定义它的文法表示，并定义一个解释器，这个解释器使用该标识来解释语言中的句子。<br><strong>主要解决：</strong>对于一些固定文法构建一个解释句子的解释器。<br><strong>何时使用：</strong>如果一种特定类型的问题发生的频率足够高，那么可能就值得将该问题的各个实例表述为一个简单语言中的句子。这样就可以构建一个解释器，该解释器通过解释这些句子来解决该问题。<br><strong>如何解决：</strong>构件语法树，定义终结符与非终结符。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface Operand &#123;</span><br><span class="line">    double evaluate(Map&lt;String, Integer&gt; context);</span><br><span class="line">    void traverse(int level);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">class Expression implements Operand &#123;</span><br><span class="line">    private char operation;</span><br><span class="line"></span><br><span class="line">    public Operand left, right;</span><br><span class="line"></span><br><span class="line">    public Expression(char operation) &#123;</span><br><span class="line">        this.operation = operation;</span><br><span class="line">    &#125;</span><br><span class="line">    public void traverse(int level) &#123;</span><br><span class="line">        left.traverse(level + 1);</span><br><span class="line">        System.out.print(&quot;&quot; + level + operation + level + &quot; &quot;);</span><br><span class="line">        right.traverse(level + 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public double evaluate(Map&lt;String, Integer&gt; context) &#123;</span><br><span class="line">        double result = 0;</span><br><span class="line">        double a = left.evaluate(context);</span><br><span class="line">        double b = right.evaluate(context);</span><br><span class="line">        if (operation == &#x27;+&#x27;) &#123;</span><br><span class="line">            result = a + b;</span><br><span class="line">        &#125;</span><br><span class="line">        if (operation == &#x27;-&#x27;) &#123;</span><br><span class="line">            result = a - b;</span><br><span class="line">        &#125;</span><br><span class="line">        if (operation == &#x27;*&#x27;) &#123;</span><br><span class="line">            result = a * b;</span><br><span class="line">        &#125;</span><br><span class="line">        if (operation == &#x27;/&#x27;) &#123;</span><br><span class="line">            result = a / b;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">class Variable implements Operand &#123;</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public Variable(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void traverse(int level) &#123;</span><br><span class="line">        System.out.print(name + &quot; &quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public double evaluate(Map&lt;String, Integer&gt; context) &#123;</span><br><span class="line">        return context.get(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Number implements Operand &#123;</span><br><span class="line">    private double value;</span><br><span class="line"></span><br><span class="line">    public Number(double value) &#123;</span><br><span class="line">        this.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void traverse(int level) &#123;</span><br><span class="line">        System.out.print(value + &quot; &quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public double evaluate(Map context) &#123;</span><br><span class="line">        return value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">public class InterpreterDemo &#123;</span><br><span class="line">    public static boolean precedence(char a, char b) &#123;</span><br><span class="line">        String high = &quot;*/&quot;, low = &quot;+-&quot;;</span><br><span class="line">        if (a == &#x27;(&#x27;) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (a == &#x27;)&#x27; &amp;&amp; b == &#x27;(&#x27;) &#123;</span><br><span class="line">            System.out.println(&quot;)-(&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (b == &#x27;(&#x27;) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (b == &#x27;)&#x27;) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">        if (high.indexOf(a) &gt;  - 1 &amp;&amp; low.indexOf(b) &gt;  - 1) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">        if (high.indexOf(a) &gt;  - 1 &amp;&amp; high.indexOf(b) &gt;  - 1) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">        //noinspection RedundantIfStatement</span><br><span class="line">        if (low.indexOf(a) &gt;  - 1 &amp;&amp; low.indexOf(b) &gt;  - 1) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static String convertToPostfix(String expr) &#123;</span><br><span class="line">        Stack&lt;Character&gt; operationsStack = new Stack&lt;&gt;();</span><br><span class="line">        StringBuilder out = new StringBuilder();</span><br><span class="line">        String operations = &quot;+-*/()&quot;;</span><br><span class="line">        char topSymbol = &#x27;+&#x27;;</span><br><span class="line">        boolean empty;</span><br><span class="line">        String[] tokens = expr.split(&quot; &quot;);</span><br><span class="line">        for (String token : tokens)</span><br><span class="line">            if (operations.indexOf(token.charAt(0)) == -1) &#123;</span><br><span class="line">                out.append(token);</span><br><span class="line">                out.append(&#x27; &#x27;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                while (!(empty = operationsStack.isEmpty()) &amp;&amp; precedence(topSymbol =</span><br><span class="line">                        operationsStack.pop(), token.charAt(0))) &#123;</span><br><span class="line">                    out.append(topSymbol);</span><br><span class="line">                    out.append(&#x27; &#x27;);</span><br><span class="line">                &#125;</span><br><span class="line">                if (!empty) &#123;</span><br><span class="line">                    operationsStack.push(topSymbol);</span><br><span class="line">                &#125;</span><br><span class="line">                if (empty || token.charAt(0) != &#x27;)&#x27;) &#123;</span><br><span class="line">                    operationsStack.push(token.charAt(0));</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    topSymbol = operationsStack.pop();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        while (!operationsStack.isEmpty()) &#123;</span><br><span class="line">            out.append(operationsStack.pop());</span><br><span class="line">            out.append(&#x27; &#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        return out.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static Operand buildSyntaxTree(String tree) &#123;</span><br><span class="line">        Stack &lt;Operand&gt; stack = new Stack&lt;&gt;();</span><br><span class="line">        String operations = &quot;+-*/&quot;;</span><br><span class="line">        String[] tokens = tree.split(&quot; &quot;);</span><br><span class="line">        for (String token : tokens)</span><br><span class="line">            if (operations.indexOf(token.charAt(0)) == -1) &#123;</span><br><span class="line">                Operand term;</span><br><span class="line">                try &#123;</span><br><span class="line">                    term = new Number(Double.parseDouble(token));</span><br><span class="line">                &#125; catch (NumberFormatException ex) &#123;</span><br><span class="line">                    term = new Variable(token);</span><br><span class="line">                &#125;</span><br><span class="line">                stack.push(term);</span><br><span class="line"></span><br><span class="line">                // If token is an operator</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                Expression expr = new Expression(token.charAt(0));</span><br><span class="line">                expr.right = stack.pop();</span><br><span class="line">                expr.left = stack.pop();</span><br><span class="line">                stack.push(expr);</span><br><span class="line">            &#125;</span><br><span class="line">        return stack.pop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        System.out.println(&quot;celsius * 9 / 5 + thirty&quot;);</span><br><span class="line">        String postfix = convertToPostfix(&quot;celsius * 9 / 5 + thirty&quot;);</span><br><span class="line">        System.out.println(postfix);</span><br><span class="line">        Operand expr = buildSyntaxTree(postfix);</span><br><span class="line">        expr.traverse(1);</span><br><span class="line">        System.out.println();</span><br><span class="line">        HashMap &lt; String, Integer &gt; map = new HashMap&lt;&gt;();</span><br><span class="line">        map.put(&quot;thirty&quot;, 30);</span><br><span class="line">        for (int i = 0; i &lt;= 100; i += 10) &#123;</span><br><span class="line">            map.put(&quot;celsius&quot;, i);</span><br><span class="line">            System.out.println(&quot;C is &quot; + i + &quot;,  F is &quot; + expr.evaluate(map));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES：<a class="link" target="_blank" rel="noopener" href="https://sourcemaking.com/design_patterns/interpreter/java/1">Interpreter Design Pattern<i class="fas fa-external-link-alt"></i></a></p><h2 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h2><p><strong>意图：</strong>将一个请求封装成一个对象，从而使您可以用不同的请求对客户进行参数化。<br><strong>主要解决：</strong>在软件系统中，行为请求者与行为实现者通常是一种紧耦合的关系，但某些场合，比如需要对行为进行记录、撤销或重做、事务等处理时，这种无法抵御变化的紧耦合的设计就不太合适。<br><strong>何时使用：</strong>在某些场合，比如要对行为进行”记录、撤销&#x2F;重做、事务”等处理，这种无法抵御变化的紧耦合是不合适的。在这种情况下，如何将”行为请求者”与”行为实现者”解耦？将一组行为抽象为对象，可以实现二者之间的松耦合。<br><strong>如何解决：</strong>通过调用者调用接受者执行命令，顺序：调用者→接受者→命令。</p><p>图示：<br><img lazyload alt="image" data-src="/images/design-pattern/Command.png" alt="Command scheme"></p><p>Code:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/* The Command interface */</span><br><span class="line">public interface Command &#123;</span><br><span class="line">   void execute();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/* The Invoker class */</span><br><span class="line">public class Switch &#123;</span><br><span class="line">   private List&lt;Command&gt; history = new ArrayList&lt;Command&gt;();</span><br><span class="line"></span><br><span class="line">   public Switch() &#123;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public void storeAndExecute(Command cmd) &#123;</span><br><span class="line">      this.history.add(cmd); // optional </span><br><span class="line">      cmd.execute();        </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">/* The Receiver class */</span><br><span class="line">public class Light &#123;</span><br><span class="line">   public Light() &#123;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public void turnOn() &#123;</span><br><span class="line">      System.out.println(&quot;The light is on&quot;);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public void turnOff() &#123;</span><br><span class="line">      System.out.println(&quot;The light is off&quot;);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* The Command for turning on the light - ConcreteCommand #1 */</span><br><span class="line">public class FlipUpCommand implements Command &#123;</span><br><span class="line">   private Light theLight;</span><br><span class="line"></span><br><span class="line">   public FlipUpCommand(Light light) &#123;</span><br><span class="line">      this.theLight = light;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public void execute()&#123;</span><br><span class="line">      theLight.turnOn();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* The Command for turning off the light - ConcreteCommand #2 */</span><br><span class="line">public class FlipDownCommand implements Command &#123;</span><br><span class="line">   private Light theLight;</span><br><span class="line"></span><br><span class="line">   public FlipDownCommand(Light light) &#123;</span><br><span class="line">      this.theLight = light;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public void execute() &#123;</span><br><span class="line">      theLight.turnOff();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">/* The test class or client */</span><br><span class="line">public class PressSwitch &#123;</span><br><span class="line">   public static void main(String[] args)&#123;</span><br><span class="line">      Light lamp = new Light();</span><br><span class="line">      Command switchUp = new FlipUpCommand(lamp);</span><br><span class="line">      Command switchDown = new FlipDownCommand(lamp);</span><br><span class="line"></span><br><span class="line">      Switch mySwitch = new Switch();</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">         if (&quot;ON&quot;.equalsIgnoreCase(args[0])) &#123;</span><br><span class="line">            mySwitch.storeAndExecute(switchUp);</span><br><span class="line">         &#125;</span><br><span class="line">         else if (&quot;OFF&quot;.equalsIgnoreCase(args[0])) &#123;</span><br><span class="line">            mySwitch.storeAndExecute(switchDown);</span><br><span class="line">         &#125;</span><br><span class="line">         else &#123;</span><br><span class="line">            System.out.println(&quot;Argument \&quot;ON\&quot; or \&quot;OFF\&quot; is required.&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">         System.out.println(&quot;Arguments required.&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES: <a class="link" target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F#Java">命令模式 - 维基百科<i class="fas fa-external-link-alt"></i></a></p><h2 id="责任链模式"><a href="#责任链模式" class="headerlink" title="责任链模式"></a>责任链模式</h2><p><strong>意图：</strong>避免请求发送者与接收者耦合在一起，让多个对象都有可能接收请求，将这些对象连接成一条链，并且沿着这条链传递请求，直到有对象处理它为止。<br><strong>主要解决：</strong>职责链上的处理者负责处理请求，客户只需要将请求发送到职责链上即可，无须关心请求的处理细节和请求的传递，所以职责链将请求的发送者和请求的处理者解耦了。<br><strong>何时使用：</strong>在处理消息的时候以过滤很多道。<br><strong>如何解决：</strong>拦截的类都实现统一接口。</p><p>图示：<br><img lazyload alt="image" data-src="/images/design-pattern/Chain_of_responsibility__.png" alt="Chain of responsibility scheme"><br>Code:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">abstract class Logger </span><br><span class="line">&#123;</span><br><span class="line">    public static int ERR = 3;</span><br><span class="line">    public static int NOTICE = 5;</span><br><span class="line">    public static int DEBUG = 7;</span><br><span class="line">    protected int mask;</span><br><span class="line"></span><br><span class="line">    // The next element in the chain of responsibility</span><br><span class="line">    protected Logger next;</span><br><span class="line">    public Logger setNext( Logger l)</span><br><span class="line">    &#123;</span><br><span class="line">        next = l;</span><br><span class="line">        return this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void message( String msg, int priority )</span><br><span class="line">    &#123;</span><br><span class="line">        if ( priority &lt;= mask ) </span><br><span class="line">        &#123;</span><br><span class="line">            writeMessage( msg );</span><br><span class="line">            if ( next != null )</span><br><span class="line">            &#123;</span><br><span class="line">                next.message( msg, priority );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    protected abstract void writeMessage( String msg );</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">class StdoutLogger extends Logger </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public StdoutLogger( int mask ) &#123; this.mask = mask; &#125;</span><br><span class="line"></span><br><span class="line">    protected void writeMessage( String msg )</span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println( &quot;Writting to stdout: &quot; + msg );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class EmailLogger extends Logger </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public EmailLogger( int mask ) &#123; this.mask = mask; &#125;</span><br><span class="line"></span><br><span class="line">    protected void writeMessage( String msg )</span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println( &quot;Sending via email: &quot; + msg );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class StderrLogger extends Logger </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public StderrLogger( int mask ) &#123; this.mask = mask; &#125;</span><br><span class="line"></span><br><span class="line">    protected void writeMessage( String msg )</span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println( &quot;Sending to stderr: &quot; + msg );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class ChainOfResponsibilityExample</span><br><span class="line">&#123;</span><br><span class="line">    public static void main( String[] args )</span><br><span class="line">    &#123;</span><br><span class="line">        // Build the chain of responsibility</span><br><span class="line">        Logger l = new StdoutLogger( Logger.DEBUG).setNext(</span><br><span class="line">                            new EmailLogger( Logger.NOTICE ).setNext(</span><br><span class="line">                            new StderrLogger( Logger.ERR ) ) );</span><br><span class="line"></span><br><span class="line">        // Handled by StdoutLogger</span><br><span class="line">        l.message( &quot;Entering function y.&quot;, Logger.DEBUG );</span><br><span class="line"></span><br><span class="line">        // Handled by StdoutLogger and EmailLogger</span><br><span class="line">        l.message( &quot;Step1 completed.&quot;, Logger.NOTICE );</span><br><span class="line"></span><br><span class="line">        // Handled by all three loggers</span><br><span class="line">        l.message( &quot;An error has occurred.&quot;, Logger.ERR );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>REFERENCES: <a class="link" target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F">责任链模式 - 维基百科<i class="fas fa-external-link-alt"></i></a></p></div><div class="post-bottom-tags-and-share border-box"><div><ul class="post-tags-box border-box"><li class="tag-item border-box"><i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/Design-Pattern/">Design Pattern</a></li></ul></div><div></div></div><div class="post-nav border-box"><div class="prev-post"><a class="prev" rel="prev" href="/2019/07/15/Immuteable-object/" title="Immuteable Object - 不可变对象"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">Immuteable Object - 不可变对象</span> <span class="post-nav-item">Prev posts</span></span></a></div></div></div></div><div class="pc-post-toc right-toc"><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="nav-text">设计模式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">创建型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="nav-text">工厂模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82"><span class="nav-text">抽象工厂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">单例模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="nav-text">生成器模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">原型模式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">结构型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F"><span class="nav-text">享元模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="nav-text">代理模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F"><span class="nav-text">外观模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E9%A5%B0%E6%A8%A1%E5%BC%8F"><span class="nav-text">修饰模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F"><span class="nav-text">桥接模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="nav-text">适配器模式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">行为型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="nav-text">访问者模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F"><span class="nav-text">模板方法模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F"><span class="nav-text">策略模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F"><span class="nav-text">状态模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="nav-text">观察者模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F"><span class="nav-text">备忘录模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="nav-text">中介者模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="nav-text">解释器模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F"><span class="nav-text">命令模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F"><span class="nav-text">责任链模式</span></a></li></ol></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom border-box"><footer class="footer border-box"><div class="border-box website-info-box default"><div class="copyright-info info-item default">&copy;&nbsp;<span>2019</span>&nbsp;-&nbsp;2023 &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">ShawJie</a></div><div class="theme-info info-item default">Powered by&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;&&nbsp;Theme&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a></div><div class="icp-info info-item default"><a target="_blank" href="https://beian.miit.gov.cn">浙ICP备20000303号-1</a></div><div class="count-item info-item default"></div></div></footer></div></div><div class="post-tools right-toc"><div class="post-tools-container border-box"><ul class="tools-list border-box"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li></ul></div></div><div class="side-tools"><div class="side-tools-container border-box"><ul class="side-tools-list side-tools-show-handle border-box"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-toggle-theme-mode flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list border-box"><li class="tools-item toggle-show-toc-tablet flex-center"><i class="fas fa-list"></i></li><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center show-arrow"><i class="arrow fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="zoom-in-image-mask"><img class="zoom-in-image"></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input"></div><span class="close-popup-btn"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div><div class="tablet-post-toc-mask"><div class="tablet-post-toc"><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="nav-text">设计模式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">创建型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="nav-text">工厂模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82"><span class="nav-text">抽象工厂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">单例模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="nav-text">生成器模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">原型模式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">结构型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F"><span class="nav-text">享元模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="nav-text">代理模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F"><span class="nav-text">外观模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E9%A5%B0%E6%A8%A1%E5%BC%8F"><span class="nav-text">修饰模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F"><span class="nav-text">桥接模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="nav-text">适配器模式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">行为型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="nav-text">访问者模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F"><span class="nav-text">模板方法模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F"><span class="nav-text">策略模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F"><span class="nav-text">状态模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="nav-text">观察者模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F"><span class="nav-text">备忘录模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="nav-text">中介者模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="nav-text">解释器模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F"><span class="nav-text">命令模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F"><span class="nav-text">责任链模式</span></a></li></ol></li></ol></div></div></div></div></main><script src="/js/utils.js"></script><script src="/js/header-shrink.js"></script><script src="/js/back2top.js"></script><script src="/js/toggle-theme.js"></script><script src="/js/code-block.js"></script><script src="/js/main.js"></script><script src="/js/libs/anime.min.js"></script><script src="/js/local-search.js"></script><script src="/js/lazyload.js"></script><div class="pjax"><script src="/js/post/post-helper.js"></script><script src="/js/post/toc.js"></script></div><script src="//cdn.jsdelivr.net/npm/mermaid@10.5.0/dist/mermaid.min.js"></script><script data-pjax>window.mermaid&&mermaid.init()</script><script src="/js/libs/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.initExecute()})})</script><script class="custom-inject-js" src="/js/shawjie_modify.js" data-pjax></script></body></html>